<!DOCTYPE html>
<html>
<head>
    <title>Ship Resistance Predictor</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body class="p-4">
    <h2 class="mb-4">Ship Resistance (Rts) Prediction App</h2>

    <form method="POST">
        <button type="submit" name="train" value="1" class="btn btn-success mb-3">Train All Models</button>
    </form>

    {% if trained_metrics %}
        <h4>Model Training Metrics</h4>
        <table class="table table-bordered">
            <thead><tr><th>Model</th><th>R2 Score</th><th>MSE</th><th>MAE</th></tr></thead>
            <tbody>
            {% for model, metrics in trained_metrics.items() %}
                <tr {% if model == best_model_name %} style="background-color: #d4edda;" {% endif %}>
                    <td><b>{{ model }}</b></td>
                    <td>{{ metrics['R2 Score'] }}</td>
                    <td>{{ metrics['MSE'] }}</td>
                    <td>{{ metrics['MAE'] }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

        <h5>Best Model: <span class="badge badge-success">{{ best_model_name }}</span></h5>

        <h4 class="mt-4">Select Model and Enter Input Parameters</h4>
        <form method="POST">
            <div class="form-group">
                <label>Select Model for Prediction</label>
                <select class="form-control" name="selected_model">
                    {% for model in model_options %}
                        <option value="{{ model }}">{{ model }}</option>
                    {% endfor %}
                </select>
            </div>

            {% for param in ['length', 'breadth', 'avg_draft', 'displacement', 'wetted_area', 'block_coeff', 'vs_start', 'vs_end', 'vs_step'] %}
                <div class="form-group">
                    <label>{{ param.replace('_', ' ').title() }}</label>
                    <input type="number" step="any" class="form-control" name="{{ param }}" required>
                </div>
            {% endfor %}

            <button type="submit" name="predict" value="1" class="btn btn-primary">Predict</button>
        </form>
    {% endif %}

    {% if prediction_table %}
        <h4 class="mt-4">Prediction Results</h4>
        {{ prediction_table|safe }}
    {% endif %}

    {% if plot_url %}
        <h4 class="mt-4">Vs vs Predicted Rts Plot</h4>
        <img src="{{ plot_url }}" class="img-fluid">
    {% endif %}
    {% if power_plot_url %}
    
        <h4>Power Analysis</h4>
        <img src="{{ power_plot_url }}" alt="Power Plot" class="img-fluid">
    
    {% endif %}
</body>
</html>
